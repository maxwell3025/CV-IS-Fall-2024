per_token_train_loss = [
    1.324987556785345,
    1.1599399360961147,
    1.1573988256443823,
    1.1567241795627135,
    1.1551904488088829,
    1.1544384747477514,
    1.1538773503686701,
    1.1534168883892042,
    1.153021517874939,
    1.1526728607714176,
    1.152363718088184,
    1.1520921549360668,
    1.1518776432744093,
    1.1517177846814906,
    1.1515659475699067,
    1.1514446938942586,
    1.151322300279779,
    1.1512124149927072,
    1.1511361390086157,
    1.1511841365801436,
    1.1509818452011262,
    1.1509396802367908,
    1.150880525553865,
    1.1508128744150912,
    1.150725603768868,
    1.1506057980337314,
    1.1506206791049667,
    1.1498750852687019,
    4.821817959525755,
    1.1533156677282281,
    1.1496589409985714,
    1.1489631489717536,
    1.1487750027860915,
    1.1486520700688874,
    1.1485405320833837,
    1.1484186483014907,
    1.148262657358178,
    1.1480175875393408,
    1.1474779769778252,
    1.1447243990509637,
    1.145914578145104,
    1.1429119247144885,
    1.1390015295972782,
    1.1479641972109675,
    1.1459438766219787,
    1.1365393376909196,
    1.126283971526261,
    1.0983778260249113,
    1.9664950451281453,
    1.1391044376151902,
    1.1317723992147617,
    1.1189828097953327,
    1.1029472573926407,
    1.092085275998605,
    1.074974230557148,
    1.0442615585800792,
    1.0150519761789059,
    1.0478386304208211,
    0.9636210907317165,
    0.9337051165223654,
    0.8873830450299595,
    0.8254351777556751,
    0.7866156535123342,
    0.7189427870824667,
    0.6263670344570917,
    0.7497365566544302,
    0.5535464527742339,
    0.5047402410293996,
    0.5175992654777863,
    0.44639801963681486,
    0.3936789760373358,
    0.3381590591204388,
    0.43364047978333736,
    0.3655205417372339,
    0.23101334662160664,
    0.17342358416071518,
    0.16434914504731163,
    0.11992410772563443,
    0.9956978540913808,
    0.1655870224566312,
    0.11948611839180394,
    0.11985828394267566,
    0.08119695647522321,
    0.07775275663041163,
    0.17410679559834122,
    0.10236862283649877,
    0.11155004389722589,
    1.8371450516431589,
    0.4196475143688271,
    0.2417059233000092,
    0.1676105900304498,
    0.11920474654874094,
    0.08116276207404437,
    0.06621551149613744,
    0.06547283572791991,
    0.04598347992605379,
    0.04659447800809822,
    0.0674487294244877,
    0.08632225155451108,
    0.046317287052706706,
]

in_context_accuracy = [
    0.5583333333333333,
    0.5583333333333333,
    0.5583333333333333,
    0.5583333333333333,
    0.55625,
    0.5541666666666667,
    0.5552083333333333,
    0.5552083333333333,
    0.5552083333333333,
    0.5552083333333333,
    0.5520833333333334,
    0.553125,
    0.5510416666666667,
    0.5520833333333334,
    0.5520833333333334,
    0.5552083333333333,
    0.5447916666666667,
    0.5479166666666667,
    0.5479166666666667,
    0.546875,
    0.546875,
    0.5458333333333333,
    0.5447916666666667,
    0.540625,
    0.5427083333333333,
    0.5427083333333333,
    0.5416666666666666,
    0.546875,
    0.540625,
    0.546875,
    0.5510416666666667,
    0.5510416666666667,
    0.5520833333333334,
    0.5520833333333334,
    0.5520833333333334,
    0.55,
    0.55,
    0.5520833333333334,
    0.5520833333333334,
    0.5489583333333333,
    0.5552083333333333,
    0.5552083333333333,
    0.55,
    0.55,
    0.5520833333333334,
    0.5541666666666667,
    0.5552083333333333,
    0.56875,
    0.5541666666666667,
    0.5645833333333333,
    0.5635416666666667,
    0.565625,
    0.565625,
    0.5697916666666667,
    0.5791666666666667,
    0.5916666666666667,
    0.6239583333333333,
    0.609375,
    0.6177083333333333,
    0.6302083333333334,
    0.6729166666666667,
    0.6947916666666667,
    0.725,
    0.7229166666666667,
    0.7333333333333333,
    0.7427083333333333,
    0.771875,
    0.7854166666666667,
    0.7927083333333333,
    0.8270833333333333,
    0.8645833333333334,
    0.8729166666666667,
    0.7833333333333333,
    0.8927083333333333,
    0.896875,
    0.9333333333333333,
    0.90625,
    0.9604166666666667,
    0.9416666666666667,
    0.9520833333333333,
    0.9604166666666667,
    0.96875,
    0.9770833333333333,
    0.9739583333333334,
    0.9552083333333333,
    0.9708333333333333,
    0.9739583333333334,
    0.7041666666666667,
    0.909375,
    0.9302083333333333,
    0.9427083333333334,
    0.9572916666666667,
    0.9677083333333333,
    0.9666666666666667,
    0.9677083333333333,
    0.9708333333333333,
    0.9572916666666667,
    0.9791666666666666,
    0.978125,
    0.9760416666666667,
]

shuffled_accuracy = [
    0.55625,
    0.55625,
    0.5541666666666667,
    0.565625,
    0.5552083333333333,
    0.5572916666666666,
    0.5625,
    0.5604166666666667,
    0.5666666666666667,
    0.5520833333333334,
    0.5541666666666667,
    0.5541666666666667,
    0.5416666666666666,
    0.5510416666666667,
    0.5625,
    0.5552083333333333,
    0.5427083333333333,
    0.5635416666666667,
    0.553125,
    0.5458333333333333,
    0.5489583333333333,
    0.55625,
    0.540625,
    0.53125,
    0.5427083333333333,
    0.5416666666666666,
    0.5375,
    0.5510416666666667,
    0.54375,
    0.5416666666666666,
    0.5447916666666667,
    0.5520833333333334,
    0.5614583333333333,
    0.5427083333333333,
    0.55625,
    0.5572916666666666,
    0.5552083333333333,
    0.5645833333333333,
    0.5541666666666667,
    0.5489583333333333,
    0.56875,
    0.5697916666666667,
    0.5635416666666667,
    0.5625,
    0.553125,
    0.553125,
    0.5572916666666666,
    0.5666666666666667,
    0.5614583333333333,
    0.578125,
    0.5583333333333333,
    0.559375,
    0.5583333333333333,
    0.5614583333333333,
    0.5739583333333333,
    0.5979166666666667,
    0.6052083333333333,
    0.596875,
    0.6,
    0.6208333333333333,
    0.6239583333333333,
    0.6302083333333334,
    0.6427083333333333,
    0.653125,
    0.653125,
    0.6552083333333333,
    0.6625,
    0.65,
    0.6677083333333333,
    0.6958333333333333,
    0.7322916666666667,
    0.721875,
    0.6958333333333333,
    0.7395833333333334,
    0.7739583333333333,
    0.8135416666666667,
    0.7822916666666667,
    0.8447916666666667,
    0.8052083333333333,
    0.828125,
    0.8489583333333334,
    0.8354166666666667,
    0.85625,
    0.865625,
    0.8125,
    0.8385416666666666,
    0.8645833333333334,
    0.6958333333333333,
    0.7791666666666667,
    0.8,
    0.8072916666666666,
    0.8239583333333333,
    0.8270833333333333,
    0.8427083333333333,
    0.83125,
    0.84375,
    0.8625,
    0.85625,
    0.875,
    0.8885416666666667,
]

import matplotlib.pyplot as plt

fig, ax = plt.subplots()

# Plot the data
ax.plot([epoch for epoch in range(1, 101)], in_context_accuracy, label="In-Context Accuracy")
ax.plot([epoch for epoch in range(1, 101)], shuffled_accuracy, label="Shuffled Accuracy")
ax.legend(loc='upper left')

# Customize the plot
ax.set_title("Sequence Stack Accuracy on Synthetic Letters")
ax.set_xticks([epoch for epoch in range(5, 101, 5)])
ax.set_xlabel("Epoch")
ax.set_ylabel("Accuracy")

# Show the plot
plt.show()
